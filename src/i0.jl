function besseli0(z::ComplexF64)
    check = false
    if real(z) < 0.0
        z = -z
    end
    if imag(z) < 0.0
        z = conj(z)
        check = true
    end

    if abs(z) > 17.5
        zinv = 1 / z
        e = exp(z)
        s = sqrt(2 * z * π)
        p = evalpoly(zinv*zinv, (1.0, 0.0703125, 0.112152099609375, 0.5725014209747314, 6.074042001273483, 110.01714026924674, 3038.090510922384, 118838.42625678325, 6.252951493434797e6, 4.259392165047669e8, 3.646840080706556e10, 3.8335346613939443e12, 4.8540146868529006e14, 7.286857349377656e16))
        p2 = zinv*evalpoly(zinv*zinv, (0.125, 0.0732421875, 0.22710800170898438, 1.7277275025844574, 24.380529699556064, 551.3358961220206, 18257.755474293175, 832859.3040162893, 5.0069589531988926e7, 3.8362551802304335e9, 3.6490108188498334e11, 4.218971570284097e13, 5.827244631566907e15, 9.47628809926011e17))
        r = e / s * (p + p2) + im * (p - p2) / (e * s)
    elseif abs(z) < 5.2
        r = evalpoly(z*z, (1.0, 0.25, 0.015625, 0.00043402777777777775, 6.781684027777777e-6, 6.781684027777778e-8, 4.709502797067901e-10, 2.4028075495244395e-12, 9.385966990329842e-15, 2.896903392077112e-17, 7.242258480192779e-20, 1.4963343967340453e-22, 2.5978027721077174e-25, 3.842903509035085e-28, 4.9016626390753635e-31, 5.4462918211948485e-34, 5.318644356635594e-37))
    else
        if angle(z) <= π / 4.4
            zz = z*z
            zz2 = zz*zz
            r = evalpoly(zz2, (1.0, 0.015625, 6.781684027777777e-6, 4.709502797067901e-10, 9.385966990329842e-15, 7.242258480192779e-20, 2.5978027721077174e-25, 4.9016626390753635e-31, 5.318644356635594e-37, 3.5500798014623073e-43, 1.5365650110207356e-49, 4.499321282809354e-56, 9.228877211181495e-63, 1.3652185223641266e-69, 1.4929270885431173e-76, 1.232764473958843e-83, 7.829549665715613e-91, 3.887148093924665e-98))
            r += zz*evalpoly(zz2, (0.25, 0.00043402777777777775, 6.781684027777778e-8, 2.4028075495244395e-12, 2.896903392077112e-17, 1.4963343967340453e-22, 3.842903509035085e-28, 5.4462918211948485e-34, 4.60090342269515e-40, 2.458504017633177e-46, 8.71068600351891e-53, 2.1263333094562166e-59, 3.691550884472598e-66, 4.681819349671216e-73, 4.4379521062518346e-80, 3.206983543077115e-87, 1.7974172786307652e-94, 7.932955293723807e-102))
        else
            zz = (-1.3144540816651462 + 20.054693865816724im, -1.2152720220184496 + 18.54146805523844im, 
                  -1.0758582968968085 + 16.41442564500392im, -0.9186088936209557 + 14.015263371275323im, 
                  -0.7533475204960969 + 11.49386205943562im, -0.5838248556039682 + 8.907445998843897im, 
                  -0.41092161465730614 + 6.269452314652046im, -0.32055227293065935 + 4.890682596894067im, 
                  16.906716750808087 + 10.865287107782516im, 0.26715371754140166 + 20.098224520867603im, 
                  4.121994532242284 + 2.6493699394695174im, 4.053028754723365 + 19.68712670537236im, 
                  -0.5018982035099 + 7.657486833198153im, 9.416081350634247 + 17.758023876497013im, 
                  1.9674895590143007 + 4.487648029332259im, -1.275759132467892 + 19.46432302583941im, 
                  7.709313889965882 + 4.954475197822861im, 13.72022229845232 + 14.68895844098729im, 
                  -0.3541218766747901 + 5.402855776372861im, -0.9973883749616251 + 15.217205990064667im, 
                  5.067285183070908 + 3.256546447342955im, 2.1309472708925585 + 19.986722185708082im, 
                  -0.8162780120038937 + 12.453995821138065im, -0.6642234573493526 + 10.134091621337502im
                  )
            w  = (0.023435912479136792 + 0.0im, -0.07518141047674767 + 0.0475948197731169im, 
                  0.02099862365431344 + 0.10227799317706024im, -0.044790606134137025 - 0.0019900581421525287im, 
                  0.05092855107420865 - 0.030284027691088355im, 0.11876822116350058 + 0.3545737241031229im, 
                  -0.2800428715703842 + 0.1385502878368521im, 0.07056156978707125 - 0.015640049217372977im, 
                  -0.06946091028316168 + 0.016066454632345423im, 0.08524646892263366 + 0.0953622756709394im, 
                  -0.02790219158045262 + 0.07064926802304639im, 0.1422314233425249 - 0.2536760604980481im, 
                  -0.20586363442913913 + 0.3014383126557577im, 0.20547145538054265 - 0.17388658146749558im, 
                  -0.13839690210608482 - 0.07997812132261209im, -0.005116954351018287 + 0.07859682420061695im, 
                  0.0409490985507271 - 0.2642881024594653im, -0.04174610452138103 - 0.23810783641445965im, 
                  -0.14078210159561536 - 0.17647153499232213im, -0.07672294420555978 + 0.08789101702567167im, 
                  -0.15544491331665283 - 0.17872134246439533im, 0.2746212867658749 + 0.0633913060138901im, 
                  0.003561860807958012 + 0.005781000943183686im, 0.22467614820711904 + 0.050873741433048215im
                  )
            f = (4.11757504005866 - 4.095512734321109im, -2.247112620034342 + 3.680759784557969im, 
                 3.7834318298173315 + 0.562243565983836im, 1.025044899237516 - 2.4295763517152302im, 
                 -1.1024728966418114 - 0.9985456859791928im, -0.7134052191604513 + 0.634168698676205im, 
                 0.35489432819051814 + 0.8984965319188546im, 0.15105140195420463 - 0.7254114647779558im, 
                 0.401057852147248 - 0.0014084695668244449im, 0.5404571564588408 - 0.1885021348797114im,
                 0.407770977742567 - 0.00680290179701475im, 0.3994965367795384 - 0.0024661141779376626im, 
                 0.8312271064319111 - 1.0050503936637845im, 0.40006191058465196 - 0.002248719754950748im, 
                 0.4055260568863696 - 0.01689191195791546im, 5.210832430161148 + 1.7413278357835171im, 
                 0.40364747476765517 - 0.003288380266379im, 0.40062798907705705 - 0.0018845654535970921im, 
                 -0.39383201186515915 - 0.17987628384333437im, -2.053184226968296 + 1.6069066509951657im, 
                 0.40617427977861376 - 0.005320233415147144im, 0.4034434765080089 - 0.006086635360116373im,
                 -0.07645988937623527 + 1.981923553555365im, 1.8844134122620073 + 0.24179792442042025im
                ).*w

            s1 = 0.0 + 0.0im
            s2 = 0.0 + 0.0im
            @fastmath for ind in eachindex(f)
                C = inv(z - zz[ind])
                s1 += C*f[ind]
                s2 += C*w[ind]
            end

        r = s1 / (s2 * sqrt(z) * exp(-z))
        end
    end
    check && (r = conj(r))
    return r
end

_besselj0(z::Complex{T}) where T <: Float64 = besseli0(z/im) 

#=
# works for x > 20.0
function i0_large_argument(z::T) where T
    c = exp(z) / sqrt(2 * pi * z)
    p = evalpoly(1/z, (1.0, 1/8, 9/128, 75/1024, 3675/32768, 59535/262144, 2401245/4194304, 57972915/33554432, 13043905875/2147483648, 418854310875/17179869184, 30241281245175/274877906944, 1212400457192925/2199023255552, 213786613951685775/70368744177664, 10278202593831046875/562949953421312, 1070401384414690453125/9007199254740992, 60013837619516978071875/72057594037927936, 57673297952355815927071875/9223372036854775808, 3694483615889146090857721875/73786976294838206464, 502860269940467106811189921875/1180591620717411303424, 36232405765710498380237842265625/9444732965739290427392, 11021897833929133607268351617203125/302231454903657293676544, 882276678992136837800861860405640625/2417851639229258349412352, T(148302689041496455735799416353639046875)/T(38685626227668133590597632)))
    return c*p
end
function i1_large_argument(z::T) where T
    c = exp(z) / sqrt(2 * pi * z)
    p = evalpoly(1/z, (1.0, -3/8, -15/128, -105/1024, -4725/32768, -72765/262144, -2837835/4194304, -66891825/33554432, -14783093325/2147483648, -468131288625/17179869184, -33424574007825/274877906944, -1327867167401775/2199023255552, -232376754295310625/70368744177664, -11100458801337530625/562949953421312, -1149690375852815671875/9007199254740992, -64152722972587114490625/72057594037927936, -61394155884765868567528125/9223372036854775808, -3918391713821821611515765625/73786976294838206464, -531595142508493798628972203125/1180591620717411303424, -38190914185478633427818266171875/9444732965739290427392, -11587123363874217382000061956546875/302231454903657293676544, -925314565772241073791147804815671875/2417851639229258349412352, -155200488531798616467697063625901328125/38685626227668133590597632))
    return c*p
end

function i0_small_argument(z::T) where T
    return evalpoly(z*z, (1.0, 1/4, 1/64, 1/2304, 1/147456, 1/14745600, 1/2123366400, 1/416179814400, 1/106542032486400, 1/34519618525593600, 1/13807847410237440000, 1/6682998146554920960000, 1/3849406932415634472960000, 1/2602199086312968903720960000, 1/2040124083669367620517232640000, 1/1836111675302430858465509376000000, 1/1880178355509689199068681601024000000, 1/2173486178969200714123395930783744000000, 1/2816838087944084125503921126295732224000000, 1/4067514198991257477227662106371037331456000000, 1/6508022718386011963564259370193659730329600000000, 1/11480152075232925103727353529021615764301414400000000, 1/22225574417650943000816156432185848119687538278400000000, 1/47029315467749395389726987010505254621258830997094400000000, 1/108355542837694606977930978072204106647380346617305497600000000, 1/270888857094236517444827445180510266618450866543263744000000000000, 1/732483469582815543170813411768099760936291143132985163776000000000000, 1/2135921797303490123886091908715778902890224973375784737570816000000000000, 1/6698250756343745028506784225732682639463745516506460937022078976000000000000, 1/22532915544340358275896822135364744399156039917527734592142273675264000000000000, 1/81118495959625289793228559687313079836961743703099844531712185230950400000000000000, 1/311819498468799613965170583438031478893280942794715802379901640027773337600000000000000, 1/1277212665728203218801338709762176937546878741687155926548077117553759590809600000000000000, 1/5563538371912053221098631419724042739954203798789251216043423924064176777566617600000000000000, 1/25725801431721334094360071684803973629548238365601497622984792224872753419468039782400000000000000, 1/126056427015434537062364351255539470784786367991447338352625481901876491755393394933760000000000000000))
end

function k0_large_argument(z::T) where T
    c = exp(-z) * sqrt(pi / (2*z))
    p = evalpoly(1/z, (1.0, -1/8, 9/128, -75/1024, 3675/32768, -59535/262144, 2401245/4194304, -57972915/33554432, 13043905875/2147483648, -418854310875/17179869184, 30241281245175/274877906944, -1212400457192925/2199023255552, 213786613951685775/70368744177664, -10278202593831046875/562949953421312, 1070401384414690453125/9007199254740992, -60013837619516978071875/72057594037927936, 57673297952355815927071875/9223372036854775808, -3694483615889146090857721875/73786976294838206464, 502860269940467106811189921875/1180591620717411303424, -36232405765710498380237842265625/9444732965739290427392, 11021897833929133607268351617203125/302231454903657293676544, -882276678992136837800861860405640625/2417851639229258349412352, T(148302689041496455735799416353639046875)/T(38685626227668133590597632)))
    return c*p
end
=#